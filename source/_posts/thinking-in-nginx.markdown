---
layout: post
title: "如何设计一个Web服务器-对Nginx的一点思考"
date: 2016-07-19 20:39:34 +0800
comments: true
categories: 
---

从去年开始就一直在看nginx的源代码。随着对nginx代码的深入，逐渐领略到了其实现的精巧之处。不得不赞叹的确是一个大师级的作品。

在看nginx代码之前，首先思考了一个问题。如果让我自己设计并实现一个http服务器，该怎么做呢？

故名思议，http服务器就是一个对外提供http服务的程序。无非是开一个socket去监听80（或者其他）端口，然后根据http协议分析客户端发来的数据，并返回响应数据的一个过程。

当然，要实现一个真正的web服务器，并没有这么简单。需要考虑的因素有很多。自己能想到的罗列如下：

- 服务器配置
- 线程模型
- 模块化
- 日志
- 容错
- 热更新
- 可扩展
- url重写
- 反向代理

就我的思路，程序的处理流程大体如此：确定一个配置文件格式，包括监听端口、url映射、虚拟主机。程序开始加载读取配置文件，根据配置文件，启动线程监听指定的端口。
