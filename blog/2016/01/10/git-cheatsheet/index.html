
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!-->
<html class="no-js" lang="zh-CN"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Git CheatSheet - 后端技术杂谈</title>
  <meta name="author" content="Mr.RowKey">
  <!--[if lt IE 9]>
    <script src="http://x.papaapp.com/farm1/a571d2/8dda131d/html5shiv.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
    <![endif]-->
  
  <meta name="description" content="Git CheatSheet Posted by Mr.RowKey in git ps:本指南会持续更新 其实一般情况下，只需要掌握git的几个常用命令即可，但是在使用的过程中难免会遇到各种复杂的需求，这时候经常需要搜索，非常麻烦，故总结了一下自己平常会用到的git操作。 上图所示， &hellip;">
  

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.rowkey.me/blog/2016/01/10/git-cheatsheet/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <!-- <script src="http://cdn.staticfile.org/jquery/1.9.1/jquery.min.js"></script> -->
  <script src="//cdn.staticfile.org/jquery/2.0.3/jquery.min.js"></script>
  <link href="/atom.xml" rel="alternate" title="后端技术杂谈" type="application/atom+xml">
  <script data-ad-client="ca-pub-8736325488820874" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link rel="stylesheet" href="/stylesheets/comment.css">
<link rel="stylesheet" href="//cdn.staticfile.org/highlight.js/9.10.0/styles/default.min.css">
<style type="text/css">
  span#cnzz_stat_icon_1257166229{
  	display: none !important
  }
  .btn_primary{
    color: #fff;
    background-color: #006dcc;
    background-image: linear-gradient(to bottom,#08c,#04c);
    border-color: rgba(0,0,0,.1) rgba(0,0,0,.1) rgba(0,0,0,.25);
    padding: 4px 12px;
    margin-bottom: 0;
    font-size: 14px;
    line-height: 20px;
    vertical-align: middle;
    cursor: pointer;
    border-radius: 4px;
    box-shadow: inset 0 1px 0 rgba(255,255,255,.2), 0 1px 2px rgba(0,0,0,.05);
    display: inline-block;
    text-align: center;
  }
  #recent-comments .comment-widget-content {
      color: #000000 !important;
  }
</style>

  

</head>
<body   >
  <header id="header" class="clearfix">    <!-- cnzz统计 -->
    <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1257166229'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1257166229%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                <a id="logo" href="/">
                   后端技术杂谈
                </a>
                <p class="description">What、Why、How</p>
            </div>
            <div id="m-search">
                <section class="widget">
    <form action="http://cn.bing.com/search" method="get" target="_blank" onsubmit="return doSearch(this)">
    <div class="content">
      <input type="text" class="textfield searchtip" name="s" placeholder="请输入关键字" size="24" value="">
    </div>
    </form>
    <form action="http://cn.bing.com/search" method="get" target="_blank" style="display:none" name="frmSearch">
    <div class="content">
      <input type="hidden" name="q" value="">
    </div>
    </form>
</section>
<script type="text/javascript">
  function doSearch(o){
    var $s = $(o).find("input[name=s]");
    var $q = $(o).next("form").find("input[name=q]");
    $q.val($s.val() + " site:rowkey.me");
    $(o).next("form").submit();
    return false;
  }
</script>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="index-nav current" href="/">首页</a>
<a class="talks-nav" href="/blog/talks">技术琐话</a>
<a class="manage-nav" href="/blog/categories/genai">GenAI</a>
<a class="manage-nav" href="/blog/categories/manage">管理</a>
<a class="architecture-nav" href="/blog/categories/architecture">架构</a>
<a class="java-nav" href="/blog/categories/java">Java</a>
<a class="categories-nav" href="/blog/categories">分类</a>
<a class="archives-nav" href="/blog/archives">归档</a>
<a class="about-nav" href="/about_me.html">关于</a>
                </nav>
            </div>
        </div>
    </div>
</header>
  <div id="body">
    <div class="container">
    	<div class="col-group">
			<div class="col-8" id="main">
  <div class="res-cons">
  <article class="post clearfix">
  
  <header>
    
      <h1 class="post-title">Git CheatSheet</h1>
    
    
      <p class="post-meta">
        








  


<time datetime="2016-01-10T10:15:30+08:00" pubdate data-updated="true"></time>
        
        
  

<span class="byline author vcard">Posted by <span class="fn">Mr.RowKey</span></span>
 in 

<span class="categories">
  
    <a class='category' href='/blog/categories/git/'>git</a>
  
</span>


        
      </p>
    
  </header>


<div class="post-content"><p><strong><em>ps:本指南会持续更新</em></strong></p>

<p>其实一般情况下，只需要掌握git的几个常用命令即可，但是在使用的过程中难免会遇到各种复杂的需求，这时候经常需要搜索，非常麻烦，故总结了一下自己平常会用到的git操作。</p>

<p><img src="/images/blog_images/git-process.png" alt="git-process" /></p>

<p>上图所示，使用git的流程一般如此，通常使用图中的六个命令即可。</p>

<!--more-->


<h2>目录</h2>

<ul>
<li><a href="#config">配置</a></li>
<li><a href="#repo">取得项目的 Git 仓库</a></li>
<li><a href="#commit">记录每次更新到仓库</a></li>
<li><a href="#remote">远程仓库的使用</a></li>
<li><a href="#branch">分支的使用</a></li>
<li><a href="#tag">标签的使用</a></li>
<li><a href="#log">日志</a></li>
<li><a href="#revert">撤销</a></li>
<li><a href="#cherrypick">选择某些commits操作</a></li>
<li><a href="#conflict">解决冲突</a></li>
<li><a href="#submodule">Submodule</a></li>
<li><a href="#subtree">Subtree</a></li>
<li><a href="#other">其他</a></li>
</ul>


<h2><a name="config"></a>配置</h2>

<ol>
<li><p>下面的命令将修改/home/[username]/.gitconfig文件，也就是说下面的配置只对每一个ssh的用户可见，所以每个人都需要做。</p>

<ul>
<li><p>修改提交者的信息</p>

<pre><code>  git config --global user.name [username]
  git config --global user.email [email]
</code></pre></li>
<li><p>修改git的message编辑器为vim</p>

<pre><code>  git config –global core.editor vim
</code></pre></li>
<li><p>在git命令中开启颜色显示</p>

<pre><code>  git config --global color.ui true
</code></pre></li>
<li><p>区分文件名大小写</p>

<pre><code>  编辑.git/config -&gt; core.ignorecase = false或者使用git mv oldFileName newFileName
</code></pre></li>
<li><p>兼容不同平台的换行符</p>

<p>  For Windows:</p>

<pre><code>  git config --global core.autocrlf true
</code></pre>

<p>  For Mac:</p>

<pre><code>  git config --global core.autocrlf input
</code></pre>

<p>  同时在ADD之前使用以下命令不再收到关于换行符的提示:</p>

<pre><code>  git config --global core.safecrlf false
</code></pre></li>
<li><p>如果使用HTTP clone遇到提交大小限制，请使用以下命令提高限值</p>

<pre><code>  git config --global http.postBuffer 524288000(bytes)
</code></pre></li>
<li><p>此外，也可以使用以下命令做相应修改</p>

<pre><code>  git config -e --global
</code></pre></li>
</ul>
</li>
<li><p>下面的命令将修改/etc/gitconfig文件，这是全局配置，所以admin来做一次就可以了。</p>

<p> 配置一些git的常用命令alias</p>

<pre><code> sudo git config --system alias.st status     #git st
 sudo git config --system alias.ci commit   #git ci
 sudo git config --system alias.co checkout  #git co
 sudo git config --system alias.br  branch  #git br
</code></pre></li>
<li><p>也可以进入工作根目录，运行git config -e，这样就只会修改工作区的.git/config文件，但是暂时还用不着.</p>

<p> git config文件的override顺序是3>1>2.</p></li>
<li><p>显示配置列表</p>

<pre><code> git config --list
</code></pre></li>
<li><p>配置密钥</p>

<pre><code> ssh-keygen -t rsa -C superhj1987@126.com #生成密钥，把公钥复制到git服务器上
 ssh -T git@github.com #测试是否成功

 #使用ssh-agent管理密码，避免后续需要身份验证的地方需要输入密码
 ssh-add -K private_key_path #添添加私钥到ssh-agent中，使用-K参数将密钥加入到密钥链中
 ssh-add -l  #查看当前计算机中存储的密钥
 ssh-add -d public_key_path #将对应的私钥从ssh-agent删除
</code></pre></li>
</ol>


<h2><a name="repo"></a>取得项目的 Git 仓库</h2>

<p>有两种取得 Git 项目仓库的方法。第一种是在现存的目录下，通过导入所有文件来创建新的 Git 仓库。第二种是从已有的 Git 仓库克隆出一个新的镜像仓库来。</p>

<ol>
<li><p>在工作目录中初始化新仓库</p>

<p> 要对现有的某个项目开始用 Git 管理，只需到此项目所在的目录，执行：</p>

<pre><code> git init 在当前目录新建一个Git代码库
 git init [projectName] 新建一个目录并初始化为Git代码库
</code></pre></li>
<li><p>从现有仓库克隆</p>

<pre><code> git clone git://github.com/superhj1987/test.git
</code></pre>

<p> 这会在当前目录下创建一个名为“test”的目录，其中包含一个 .git 的目录，用于保存下载下来的所有版本记录，然后从中取出最新版本的文件拷贝。</p></li>
</ol>


<h2><a name="commit"></a>记录每次更新到仓库</h2>

<ol>
<li><p>检查当前文件状态</p>

<pre><code> git status
</code></pre></li>
<li><p>跟踪新文件、暂存已修改文件</p>

<p> 使用命令<strong>git add [dirName] [fileName1] [fileName2]</strong>(支持正则)开始跟踪一个新文件/文件夹(包括子文件夹)。实际上只是add file into staged area，并没有提交文件。</p>

<p> 此外：</p>

<pre><code> git add . 添加当前目录的所有文件到暂存区
 git add --a 添加所有文件和目录到暂存区(自己最常用的)
</code></pre></li>
<li><p>忽略未纳入版本管理的某些文件/文件夹</p>

<p> 一般我们总会有些文件无需纳入 Git的管理，也不希望它们总出现在未跟踪文件列表。通常都是些自动生成的文件，比如日志文件，或者编译过程中创建的临时文件等。我们可以创建一个名为 .gitignore的文件，列出要忽略的文件模式。</p>

<p> 文件.gitignore 的格式规范如下：</p>

<ul>
<li>所有空行或者以注释符号 ＃ 开头的行都会被 Git 忽略。</li>
<li>可以使用标准的 glob 模式匹配。 * 匹配模式最后跟反斜杠（/）说明要忽略的是目录。 * 要忽略指定模式以外的文件或目录，可以在模式前加上惊叹号（!）取反。</li>
<li>所谓的 glob 模式是指 shell 所使用的简化了的正则表达式。星号（*）匹配零个或多个任意字符；[abc] 匹配任何一个列在方括号中的字符（这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c）；问号（?）只匹配一个任意字符；如果在方括号中使用短划线分隔两个字符，表示所有在这两个字符范围内的都可以匹配（比如 [0-9] 表示匹配所有 0 到 9 的数字）。</li>
</ul>


<p> 此外，忽略未纳入版本管理的文件或文件夹的方式还有：</p>

<ul>
<li>可以为自己配置一个全局的ignore文件，位于任何版本库之外：$ git config &ndash;global core.excludesfile ~/.gitignoreglobal</li>
<li>.git/info/exclude文件里设置你自己本地需要排除的文件,不会影响到其他人,也不会提交到版本库中去</li>
</ul>
</li>
<li><p>忽略已经在版本库里的文件/文件夹</p>

<ul>
<li><p>告诉git忽略对已经纳入版本管理的文件a的修改,git会一直忽略此文件直到重新告诉git可以再次跟踪此文件:</p>

<pre><code>  git update-index --assume-unchanged a
</code></pre></li>
<li><p>告诉git恢复跟踪a</p>

<pre><code>  git update-index -—no-assume-unchanged a
</code></pre></li>
<li><p>查看当前被忽略的、已经纳入版本库管理的文件</p>

<pre><code>  git ls-files -v | grep -e "^[hsmrck]"
</code></pre></li>
</ul>
</li>
<li><p>查看已暂存和未暂存的更新、提交之间的差异</p>

<p> git status 的显示比较简单，仅仅是列出了修改过的文件，如果要查看具体修改了什么地方，可以用 git diff 命令。</p>

<ul>
<li>git diff #查看尚未暂存的文件更新了哪些部分</li>
<li>git diff &ndash;cached [file] #看已经暂存起来的文件和上次提交时的快照之间的差异</li>
<li>git diff [branch1] [branch2] #显示两次提交之间的差异</li>
</ul>
</li>
<li><p>提交更新</p>

<p> 每次准备提交前，先用git status看下，是不是都已暂存起来了，然后再运行提交命令git commit提交更新</p>

<ul>
<li>git commit [file1] [file2] 提交会提示输入本次提交说明</li>
<li>git commit -m [messag] 直接附带提交说明</li>
<li>git commit &ndash;amend#修改最后一次提交</li>
<li>git commit -v 提交时显示所有diff信息</li>
<li>git commit &ndash;amend -m [message] 使用一次新的commit，替代上一次提交,如果代码没有任何新变化，则用来改写上一次commit的提交信息</li>
<li>git commit &ndash;amend [file1] [file2] &hellip; 重做上一次commit，并包括指定文件的新变化</li>
</ul>
</li>
<li><p>跳过使用暂存区域</p>

<p> git commit -a 跳过git add步骤直接commit</p></li>
<li><p>移除文件
 要从 Git 中移除某个文件（包括暂存区域和工作目录），就必须要从已跟踪文件清单中移除（确切地说，是从暂存区域移除），然后提交。
可以用 git rm 命令完成此项工作，并连带从工作目录中删除指定的文件，这样以后就不会出现在未跟踪文件清单中了。</p>

<pre><code>  git rm [file1] [file2]
</code></pre>

<p>  最后提交的时候，该文件就不再纳入版本管理了。
  如果删除之前修改过并且已经放到暂存区域的话，则必须要用强制删除选项 -f（即 force的首字母），以防误删除文件后丢失修改的内容。</p>

<p>  另外一种情况是，我们想把文件从 Git 仓库中删除（亦即从暂存区域移除），但仍然希望保留在当前工作目录中。换句话说，仅是从跟踪清单中删除。比如一些编译文件，不小心纳入仓库后，要移除跟踪但不删除文件，以便稍后在 .gitignore 文件中补上，用 &ndash;cached 选项即可：</p>

<pre><code>  git rm --cached [file]
</code></pre>

<p>  后面可以列出文件或者目录的名字，也可以使用 glob 模式。比方说：</p>

<pre><code>  git rm log/\*.log
</code></pre>

<p>  注意到星号 * 之前的反斜杠 \，因为 Git 有它自己的文件模式扩展匹配方式，所以我们不用 shell 来帮忙展开。实际上不加反斜杠也可以运行，只不过按照shell扩展的话，仅仅删除指定目录下的文件而不会递归匹配。上面的例子本来就指定了目录，所以效果等同，但下面的例子就会用递归方式匹配，所以必须加反斜杠。比如：</p>

<pre><code>  git rm \*~
</code></pre>

<p>  会递归删除当前目录及其子目录中所有 ~ 结尾的文件。</p></li>
<li><p>移动文件</p>

<p> 要在 Git 中对文件改名，可以运行如下命令</p>

<pre><code> git mv file_from file_to
</code></pre>

<p> 其实，运行 git mv 就相当于运行了下面三条命令：</p>

<pre><code> $ mv README.txt README
 $ git rm README.txt
 $ git add README
</code></pre></li>
<li><p>回滚文件</p>

<pre><code>git branch backup // 先备份到一个新分支
git log // 找到要回滚的版本
git reset --hard 版本号 // 回滚
</code></pre></li>
</ol>


<h2><a name="remote"></a>远程仓库的使用</h2>

<p>远程仓库是指托管在网络上的项目仓库，可能会有好多个，其中有些你只能读，另外有些可以写。</p>

<ol>
<li><p>查看当前的远程库</p>

<p> 要查看当前配置有哪些远程仓库，可以用 git remote 命令，它会列出每个远程库的简短名字。在克隆完某个项目后，至少可以看到一个名为 origin 的远程库，也可以加上 -v 选项git remote -v，显示对应的克隆地址。</p></li>
<li><p>添加远程仓库</p>

<p> 要添加一个新的远程仓库，可以指定一个简单的名字，以便将来引用，运行 git remote add [shortname] [url]</p></li>
<li><p>从远程同步信息</p>

<pre><code> git fetch [remote] #下载仓库的所有变动
 git pull [remote] [branch] #取回远程仓库的变化冰河本地分支合并
</code></pre></li>
<li><p>推送数据到远程仓库</p>

<p> 项目进行到一个阶段，要同别人分享目前的成果，可以将本地仓库中的数据推送到远程仓库。实现这个任务的命令很简单：</p>

<pre><code> git push [remote-name] [branch-name]。
</code></pre>

<p> 如果要把本地的 master 分支推送到 origin 服务器上（再次说明下，克隆操作会自动使用默认的 master 和 origin 名字），可以运行下面的命令：</p>

<pre><code> git push origin master

 git push -u origin master //push同时设置默认跟踪分支
</code></pre>

<p> 只有在所克隆的服务器上有写权限，或者同一时刻没有其他人在推数据，这条命令才会如期完成任务。如果在你推数据前，已经有其他人推送了若干更新，那你的推送操作就会被驳回。你必须先把他们的更新merge到本地才能继续。</p>

<p> 此外，当你本地的版本落后于远程仓库，但是你想要用旧版本覆盖远程版本的话，使用</p>

<pre><code> git push --force origin master
</code></pre>

<p> 推送所有分支到远程仓库：</p>

<pre><code> git push [remote] --all
</code></pre></li>
<li><p>查看远程仓库信息</p>

<p> 我们可以通过命令 git remote show [remote-name]查看某个远程仓库的详细信息，比如要看所克隆的 origin 仓库，可以运行：</p></li>
<li><p>远程仓库的删除和重命名</p>

<p> 在新版 Git 中可以用 git remote rename 命令修改某个远程仓库在本地的简短名称。使用git remote rm 命令删除远程仓库。</p></li>
<li><p>检出远程仓库的某一分支</p>

<pre><code> git checkout -b &lt;local.branch&gt; &lt;remote.branch&gt;
 git checkout -t &lt;x
</code></pre></li>
</ol>


<h2><a name="branch"></a>分支的使用</h2>

<p>分支是在开发中经常使用的一个功能。</p>

<pre><code>git branch 列出本地分支
git branch -r 列出远端分支
git branch -a 列出所有本地分支和远程分支
git branch -v#查看各个分支最后一个提交对象的信息
git branch --merge#查看已经合并到当前分支的分支
git branch --no-merge#查看为合并到当前分支的分支

git branch [branch-name] 新建分支,但仍然停留在当前分支
git branch [branch] [commit] 新建一个分支，指向指定commit
git branch -m &lt;old_branch_name&gt; &lt;new_branch_name&gt; 重命名分支
git checkout [branch-name] 切换到分支
git checkout -b [branch-name] 新建+切换到该分支
git checkout -b [branch1] [branch2] 基于branch2新建branch1分支，并切换

git branch -d [branch-name] 删除分支
git branch -D [branch-name] 强制删除分支

git merge [branch-name] 将分支合并到当前分支
git rebase [branch-name] 将banch-name分支上超前的提交，变基到当前分支

git branch --set-upstream [branch] [remote-branch] 建立现有分支和指定远程分支的追踪关系

# 删除远程分支
git push origin --delete [branch-name]
git push origin :[branch-name]
git branch -dr [remote/branch-name]
</code></pre>

<h2><a name="tag"></a>标签的使用</h2>

<p>当你完成一个版本的开发，需要做发布的时候，会需要给此次版本打一个表标签：</p>

<pre><code>git tag #列出现有标签

git tag [tag] #新建标签
git tag [tag] #新建一个tag在当前commit
git tag [tag] [commit] #新建一个tag在指定commit
git tag -a [tag] -m 'tag cooment' #新建带注释标签
git checkout -b [branch] [tag] #新建一个分支，指向某个tag

git show [tag] #查看tag信息

git checkout [tagn] #切换到标签

git push [remote] [tag] #推送分支到源上
git push [remote] --tags #一次性推送所有分支

git tag -d [tag] #删除标签
git push origin :refs/tags/v0.1 #删除远程标签
</code></pre>

<h2><a name="log"></a>日志</h2>

<p>有时候需要查看版本的日志记录，以确定、跟踪代码的变化等</p>

<pre><code>git log #显示当前分支的版本历史
git log --stat #显示commit历史，以及每次commit发生变更的文件，每次提交的文件增删数量

#显示某个文件的版本历史，包括文件改名
git log --follow [file] 
git whatchanged [file]

git blame [file] #显示指定文件由谁何时修改过

git log -p [file] #显示指定文件相关的每一次diff

git show [commit] #显示每次提交的元数据和内容变化
git show --name-only [commit] #显示某次提交发生变化的文件
git show [commit]:[filename] #显示某次提交某个文件的内容

git reflog #显示当前分支的最近几次提交


##下面是git log的高级用法##

git log --oneline #把每一个提交压缩到一行

git log --decorate #显示指向这个提交的所有引用（比如说分支、标签等）
git shortlog #把每个提交按作者分类，显示提交信息的第一行。这样可以容易地看到谁做了什么
git log --graph #绘制一个ASCII图像来展示提交历史的分支结构
git log -&lt;n&gt; #限制显示的提交数量

# 按照现实日期过滤显示结果，日期可以使用多种格式，如2015-1-1, yesterday
git log --after="&lt;date&gt;" #在日期之后
git log --before="&lt;date&gt;" #在日期之前

git log --author="&lt;author&gt;" #按照作者(作者的邮箱地址也算作是作者的名字)

git log --no-merges #排除外来的和并提交
git log --merges #只显示外来合并提交

git log master..feature #从master分支fork到feature分支后发生的变化

git log -- xxx.java #--告诉后面是文件名不是分支名

git log --grep="xxx" #按提交信息来过滤提交
git log &lt;last release&gt; HEAD --grep feature #仅仅显示本次发布新增加的功能。

git log -S "xxx"(-G"&lt;regex&gt;") #根据内容(源代码)来过滤提交
git log --pretty=format:"&lt;string&gt;" #自定义输出格式，占位符：%cn-作者名字 %h-缩略标识 %cd-提价日期
git log &lt;last tag&gt; HEAD --pretty=format:%s #显示上次发布后的变动，每个commit占据一行
</code></pre>

<h2><a name="revert"></a>撤销</h2>

<p>在提交了错误的修改或者想撤销文件的变动时，需要以下命令：</p>

<pre><code>git checkout [file] #恢复暂存区的指定文件到工作区
git checkout [commit] [file] #恢复某个commit的指定文件到工作区
git checkout . #回复上一个commit的所有文件到工作区

git reset --hard #重置暂存区和工作区到上一次commit
git reset [commit] [file] #重置当前分支到commit，重置暂存区，但工作区不变
git reset —soft #只回退commit,此时可以直接git commi
git reset --hard [commit] #重置当前分支的HEAD为指定commit，同时重置暂存区和工作区，与指定commit一致
git reset --keep [commit] #重置当前HEAD为指定commit,但保持暂存区和工作区不变

#新建一个commit撤销指定commit,后者的所有变化都将被前者抵消，并且应用到当前分支
git revert [commit] 
#回退所有内容到上一个版本
git　reset　HEAD^
#回退文件的版本到上一个版本
git　reset　HEAD^　[file]
#向前回退到第3个版本
git　reset　--soft　HEAD~3   

# 清空未进入暂存区的改动
git clean -f -d
</code></pre>

<h2><a name="cherrypick"></a>选择某些commit操作</h2>

<p>git cherry-pick可以选择某一个分支中的一个或几个commit(s)来进行操作。例如，假设我们有个稳定版本的分支，叫v2.0，另外还有个开发版本的分支v3.0，我们不能直接把两个分支合并，这样会导致稳定版本混乱，但是又想增加一个v3.0中的功能到v2.0中，这里就可以使用cherry-pick了。</p>

<pre><code>git cherry-pick &lt;commit id&gt;
</code></pre>

<h2><a name="conflict"></a>解决冲突</h2>

<p>在rebase或者merge时，有时候会产生conflicts，如果无法auto merge，那么一般有两种处理方式：</p>

<ul>
<li>手动修改冲突的文件：修改完成后，使用git add,git commit或者git rebase &ndash;continue等后续操作即可。</li>
<li><p>使用任一方的文件最为最新文件</p>

<pre><code>  git checkout --ours xx
  git checkout --theirs xx
</code></pre></li>
</ul>


<h2><a name="submodule"></a>Submodule</h2>

<p>当你的工程的部分文件是另一个git库时，可以使用submodule（现在subtree已经替代了submodule）。</p>

<ol>
<li><p>添加</p>

<p> 为当前工程添加submodule，命令如下：</p>

<pre><code> git submodule add 仓库地址 路径
</code></pre></li>
<li><p>删除</p>

<p> submodule的删除稍微麻烦点：首先，要在“.gitmodules”文件中删除相应配置信息。然后，执行“git rm –cached ”命令将子模块所在的文件从git中删除。</p></li>
<li><p>下载的工程带有submodule</p>

<p> 当使用git clone下来的工程中带有submodule时，初始的时候，submodule的内容并不会自动下载下来的，此时，只需执行如下命令：</p>

<pre><code> git submodule update --init --recursive
</code></pre></li>
</ol>


<h2><a name="subtree"></a>Subtree</h2>

<ol>
<li><p>第一次添加子目录，建立与git项目的关联</p>

<pre><code> git remote add -f &lt;子仓库名&gt; &lt;子仓库地址&gt; #其中-f意思是在添加远程仓库之后，立即执行fetch。
 git subtree add --prefix=&lt;子目录名&gt; &lt;子仓库名&gt; &lt;分支&gt; --squash #–squash意思是把subtree的改动合并成一次commit，这样就不用拉取子项目完整的历史记录。–prefix之后的=等号也可以用空格。
</code></pre></li>
<li><p>从远程仓库更新子目录</p>

<pre><code> git fetch &lt;远程仓库名&gt; &lt;分支&gt;
 git subtree pull --prefix=&lt;子目录名&gt; &lt;远程分支&gt; &lt;分支&gt; --squash
</code></pre></li>
<li><p>从子目录push到远程仓库（确认你有写权限）</p>

<pre><code> git subtree push --prefix=&lt;子目录名&gt; &lt;远程分支名&gt; 分支
</code></pre></li>
</ol>


<h2><a name="other"></a>其他</h2>

<pre><code>git help #获取命令的帮助信息
git archive #生成一个可供发布的压缩包
git rev-list --max-count=1 HEAD #查看当前分支的最新rev
git filter-branch -f --env-filter "GIT_AUTHOR_NAME='Newname'; GIT_AUTHOR_EMAIL='newemail'; GIT_COMMITTER_NAME='Newname'; GIT_COMMITTER_EMAIL='newemail';" HEAD #可以修改历史记录中的作者名字和邮箱
git filter-branch --index-filter 'git rm --cached --ignore-unmatch *.sql' # 删除sql文件的历史记录
</code></pre>
</div>
<!-- <div style="width:100%;text-align:center;display: none" id="wxFooter">
  <img src="/images/blog_images/h.png"/>
  <p style="color: rgb(58, 65, 69);"><strong>ID: servertalk</strong></p>
  <img src="/images/blog_images/mp-qrcode.jpg"/>
  <p style="color: rgb(178, 178, 178);"><strong>关注[<span style="color:red !important;">后端技术杂谈</span>]</strong></p>
  <p style="color: rgb(178, 178, 178);"><strong>把握后端技术</strong></p>
</div>
<script>
var browser = {
  versions: function () {
      var u = navigator.userAgent, app = navigator.appVersion;
      return {         //移动终端浏览器版本信息
          trident: u.indexOf('Trident') > -1, //IE内核
          presto: u.indexOf('Presto') > -1, //opera内核
          webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
          gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
          mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
          ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
          android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或uc浏览器
          iPhone: u.indexOf('iPhone') > -1, //是否为iPhone或者QQHD浏览器
          iPad: u.indexOf('iPad') > -1, //是否iPad
          webApp: u.indexOf('Safari') == -1 //是否web应该程序，没有头部与底部
      };
  }(),
  language: (navigator.browserLanguage || navigator.language).toLowerCase()
}
if (browser.versions.mobile) {//判断是否是移动设备打开。browser代码在下面
  // var ua = navigator.userAgent.toLowerCase();//获取判断用的对象
  // if (ua.match(/MicroMessenger/i) == "micromessenger") {
  $("div#wxFooter").show();
  // }
  // if (ua.match(/WeiBo/i) == "weibo") {
  //         //在新浪微博客户端打开
  // }
  // if (ua.match(/QQ/i) == "qq") {
  //         //在QQ空间打开
  // }
  // if (browser.versions.ios) {
  //         //是否在IOS浏览器打开
  // } 
  // if(browser.versions.android){
  //         //是否在安卓浏览器打开
  // }
} 
</script> -->


  <div class="_dj8d8fo8gk" style="display:none"></div>
  <div class="_ywga8i2zs8c"></div>
  <footer class="post-footer">
    
      <!-- <div class="sharing">
  
  
  
</div>
 -->
 <div class="share"  style='margin-bottom:15px'>

</div>

    
    <div class="meta">
      
        <a class="basic-alignment left" style="float:left !important" href="/blog/2016/01/18/io-model/" title="上一篇: 也谈IO模型">&laquo; 也谈IO模型 </a>
      
      
        <a class="basic-alignment right" style="float:right !important" href="/blog/2015/12/31/dev-job-talk/" title="下一篇: 研发招聘之殇">研发招聘之殇 &raquo;</a>
      
    </div>
  </footer>
</article>


<h2>评论</h2>
<div id="comment-thread"></div>

  </div>
</div>

  <aside id="secondary">
  <div id="sidebar">
  
    <section class="widget" style="font-size:9pt" id="ads">
    <div class="_azq7d9qhrfo"></div>
</section><section class="widget" style="font-size:9pt" id="copyright">
<p><span style="font-weight:bold">版权声明：</span>本博客所有文章为博主原创或翻译文章，采用<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">知识共享署名-非商业性使用-相同方式共享4.0</a> 国际许可协议共享，转载请注明作者和原文链接。</p>
</section><section class="widget">
    <form action="http://cn.bing.com/search" method="get" target="_blank" onsubmit="return doSearch(this)">
    <div class="content">
      <input type="text" class="textfield searchtip" name="s" placeholder="请输入关键字" size="24" value="">
    </div>
    </form>
    <form action="http://cn.bing.com/search" method="get" target="_blank" style="display:none" name="frmSearch">
    <div class="content">
      <input type="hidden" name="q" value="">
    </div>
    </form>
</section>
<script type="text/javascript">
  function doSearch(o){
    var $s = $(o).find("input[name=s]");
    var $q = $(o).next("form").find("input[name=q]");
    $q.val($s.val() + " site:rowkey.me");
    $(o).next("form").submit();
    return false;
  }
</script><!--公告-->
<section class="widget" id="notice">
	<p><a href="https://tech.wekoi.cn/" target="_blank">微鲤技术团队</a>长期求各研发职位，感兴趣者可发送简历到<a href="mailto:hang@wekoi.cn">hang@wekoi.cn</a>。</p>
	<div style="margin-bottom: 10px">
	原博客：<a href="http://srhang.iteye.com/" target="_blank">http://srhang.iteye.com/</a>
	</div>
</section><section class="widget" id="social">
		
		<a class="weibo" href="http://weibo.com/superhj1987" title="Weibo" target="_blank">Weibo</a>
		
		
			<a class="github" href="https://github.com/superhj1987" title="GitHub" target="_blank">GitHub</a>
		
		
		
		<!-- 
			<a class="linkedin" href="http://www.linkedin.com/in/superhj1987" title="LinkedIn" target="_blank">LinkedIn</a>
		 -->
		
		
		
		
		
		
    	
    	
			<a class="rss" href="/atom.xml" title="RSS" target="_blank">RSS</a>
		
</section><section class="widget">
	<h3 class="widget-title">最新文章</h3>
	<ul class="widget-list">
		
     	<li>
      	  <a href="/blog/2023/11/30/openai-func/">Langchain代理和OpenAI函数调用的区别</a>
      	</li>
    	
     	<li>
      	  <a href="/blog/2023/07/30/build-gpt-chatbot/">【译】如何基于开源技术构建类似ChatGPT的聊天机器人</a>
      	</li>
    	
     	<li>
      	  <a href="/blog/2023/05/29/web3/">Web3学习笔记-Web3是什么？</a>
      	</li>
    	
     	<li>
      	  <a href="/blog/2022/06/04/arch-usage/">架构简明指南2022最新版</a>
      	</li>
    	
     	<li>
      	  <a href="/blog/2022/05/04/article-notes/">阅文笔记202205</a>
      	</li>
    	
     	<li>
      	  <a href="/blog/2022/02/13/my2021/">我的2021</a>
      	</li>
    	
     	<li>
      	  <a href="/blog/2021/08/13/game/">做游戏业务以来的一些感悟</a>
      	</li>
    	
     	<li>
      	  <a href="/blog/2021/03/31/ali-manage/">阿里巴巴管理三板斧</a>
      	</li>
    	
     	<li>
      	  <a href="/blog/2021/01/13/my2020/">我的2020</a>
      	</li>
    	
     	<li>
      	  <a href="/blog/2020/08/13/dev-efficacy-talk/">研发效能杂谈</a>
      	</li>
    	
	</ul>
</section>
<section class="widget" style="margin-bottom: 0px !important">
	<h3 class="widget-title">最新评论</h3>
	<div id="recent-comments">暂无</div>
</section>


<section>
  <h3 class="widget-title">GitHub Repos</h3>
  <ul id="gh_repos" class="widget-list">
    <li class="loading">数据读取中...</li>
  </ul>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'superhj1987',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section class="widget">
	<h3 class="widget-title">技术酷站</h3>
	<ul class="widget-list">
		<li><a href="https://tech.wekoi.cn/" target="_blank">微鲤技术团队</a></li>
     	<li><a href="http://toutiao.io/" target="_blank">开发者头条</a></li>
     	<li><a href="https://dzone.com/java-jdk-development-tutorials-tools-news" target="_blank">DZone - Java Zone</a></li>
		<li><a href="http://ifeve.com/" target="_blank">并发编程网</a></li>
	</ul>
</section>
  
  </div>
</aside>


      	</div>
    </div>
  </div>
  <footer id="footer">
  	<div class="container">
	Copyright &copy; 2023 - Mr.RowKey - 京ICP备20027460号 -
  <span class="credit">Powered by <a rel="nofollow" href="http://octopress.org">Octopress</a></span>
  - <span class="credit">Theme by <a rel="nofollow" href="http://pagecho.com">Cho</a></span>


</div>
<link href="/stylesheets/scrollUp.min.css" media="screen, projection" rel="stylesheet" type="text/css">
<script type="text/javascript" src="/javascripts/libs/jquery.scrollUp.min.js"></script>
<script src="//cdn.staticfile.org/marked/0.3.6/marked.min.js"></script>
<script src="//cdn.staticfile.org/timeago.js/3.0.1/timeago.min.js"></script>
<script src="//cdn.staticfile.org/spin.js/2.3.2/spin.min.js"></script>
<script src="//cdn.staticfile.org/highlight.js/9.10.0/highlight.min.js"></script>
<script type="text/javascript">
  marked.setOptions({
  highlight: function (code, lang) {
     return hljs.highlightAuto(code).value;
  }
  });
  function Highlighting(){
    var markdowns = document.getElementsByClassName('markdown');
    for(var i=0;i<markdowns.length;i++){
       if(markdowns[i].innerHTML) markdowns[i].innerHTML =marked(markdowns[i].innerHTML);
    }
  }
  window.addEventListener('DOMContentLoaded', Highlighting, false);
  window.addEventListener('load', Highlighting, false);
</script>
<script src="/javascripts/comment.js"></script>
<script type="text/javascript">
$(function(){
	$.scrollUp({
		appendId: 'footer'
	});
});
var opt = {
   type: "github",
   user: "superhj1987",
   repo: "superhj1987.github.io",
   no_comment: "还没有评论",
   go_to_comment: "点击评论",
   issue_title: "Git CheatSheet",
   btn_class: "btn_primary",
   comments_target: "#comment-thread",
   loading_target: "#loading-spin",
   client_id: "",
   client_secret: ""
};
getComments(opt);
opt = {
   type: "github",
   user: "superhj1987",
   repo: "superhj1987.github.io",
   recent_comments_target: "#recent-comments",
   count: 5,
   client_id: "",
   client_secret: ""
};
getRecentCommentsList(opt);
</script>
<script type="text/javascript">
   (window.slotbydup = window.slotbydup || []).push({
       id: "u6803601",
       container: "_azq7d9qhrfo",
       async: true
   });
   (window.slotbydup = window.slotbydup || []).push({
       id: "u6803483",
       container: "_ywga8i2zs8c",
       async: true
   });
   (window.slotbydup = window.slotbydup || []).push({
       id: "u6803481",
       container: "_dj8d8fo8gk",
       async: true
   });
</script>
<!-- 多条广告如下脚本只需引入一次 -->
<script type="text/javascript" src="//cpro.baidustatic.com/cpro/ui/cm.js" async="async" defer="defer" >
</script>
  </footer>
  











</body>
</html>
